<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendrier Newsletters 2026 - Vattenfall</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #0057B8 0%, #003d82 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #0057B8 0%, #003d82 100%);
            color: white;
            padding: 40px 30px;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 300px;
            height: 300px;
            background: #FDD20A;
            border-radius: 50%;
            opacity: 0.1;
            transform: translate(50%, -50%);
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 16px;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }
        
        .controls {
            padding: 25px 30px;
            background: #f5f5f5;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
            border-bottom: 3px solid #FDD20A;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-group label {
            font-weight: 600;
            color: #003d82;
            font-size: 14px;
        }
        
        select, input[type="text"] {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
            background: white;
        }
        
        select:hover, input[type="text"]:hover {
            border-color: #0057B8;
        }
        
        select:focus, input[type="text"]:focus {
            outline: none;
            border-color: #0057B8;
            box-shadow: 0 0 0 3px rgba(0, 87, 184, 0.1);
        }
        
        .btn {
            padding: 10px 20px;
            background: #FDD20A;
            color: #003d82;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            font-size: 14px;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(253, 210, 10, 0.3);
        }
        
        .btn:hover {
            background: #e5bd00;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(253, 210, 10, 0.4);
        }
        
        .btn-secondary {
            background: #0057B8;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 87, 184, 0.3);
        }
        
        .btn-secondary:hover {
            background: #003d82;
            box-shadow: 0 6px 16px rgba(0, 87, 184, 0.4);
        }
        
        .team-info {
            background: linear-gradient(to right, #FDD20A 0%, #fde44d 100%);
            padding: 20px 30px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            border-bottom: 3px solid #0057B8;
        }
        
        .team-member {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.5);
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
        }
        
        .team-member:hover {
            background: rgba(255,255,255,0.9);
            transform: translateY(-2px);
        }
        
        .team-member strong {
            color: #003d82;
        }
        
        .calendar-grid {
            padding: 30px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1400px;
        }
        
        th {
            background: #0057B8;
            color: white;
            padding: 14px 10px;
            text-align: center;
            font-weight: 600;
            font-size: 12px;
            border: 1px solid #003d82;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        th.main-header {
            background: #003d82;
            font-size: 13px;
            font-weight: 700;
        }
        
        td {
            padding: 12px 10px;
            text-align: center;
            border: 1px solid #e0e0e0;
            font-size: 12px;
        }
        
        td.month {
            background: #f5f5f5;
            font-weight: 700;
            color: #003d82;
            text-align: left;
            padding-left: 20px;
            position: sticky;
            left: 0;
            z-index: 5;
            border-right: 3px solid #FDD20A;
        }
        
        td.empty {
            background: #fafafa;
        }
        
        .date-cell {
            background: #fff;
            transition: all 0.3s;
            position: relative;
        }
        
        .date-cell:hover {
            background: #e8f4fd;
            transform: scale(1.02);
            box-shadow: 0 2px 8px rgba(0, 87, 184, 0.15);
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 16px;
            font-size: 11px;
            font-weight: 700;
            margin-top: 4px;
            text-transform: uppercase;
        }
        
        .status-termine {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .status-encours {
            background: #FDD20A;
            color: #003d82;
            border: 2px solid #e5bd00;
            animation: pulse-status 2s infinite;
        }
        
        .status-avenir {
            background: #cfe2ff;
            color: #0057B8;
            border: 2px solid #b6d4fe;
        }
        
        .days-remaining {
            font-size: 11px;
            color: #003d82;
            font-weight: 700;
        }
        
        .phase-presta {
            background: #e8f4fd;
        }
        
        .phase-b2b {
            background: #cfe2ff;
        }
        
        .phase-comm {
            background: #fff9e6;
        }
        
        .phase-client {
            background: #ffe6e6;
        }

        /* --- Fix contraste : textes blancs sur en-t√™tes √† fond clair --- */
        th.phase-presta,
        th.phase-b2b,
        th.phase-comm,
        th.phase-client {
            color: #111;
        }
        
        .legend {
            padding: 25px 30px;
            background: #f5f5f5;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 25px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            font-weight: 600;
            color: #003d82;
        }
        
        .legend-color {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            border: 2px solid #ddd;
        }
        
        .stats {
            padding: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            background: #fafafa;
            border-top: 3px solid #FDD20A;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #0057B8 0%, #003d82 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0, 87, 184, 0.25);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(253, 210, 10, 0.2) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        
        .stat-number {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }
        
        .stat-label {
            font-size: 15px;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }
        
        .highlight-upcoming {
            animation: pulse-row 2s infinite;
        }
        
        @keyframes pulse-row {
            0%, 100% { background-color: transparent; }
            50% { background-color: rgba(253, 210, 10, 0.1); }
        }
        
        @keyframes pulse-status {
            0%, 100% { box-shadow: 0 0 0 0 rgba(253, 210, 10, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(253, 210, 10, 0); }
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 24px;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .control-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            th, td {
                font-size: 10px;
                padding: 8px 6px;
            }
            
            .team-info {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìß Calendrier Newsletters Grands Comptes 2026</h1>
            <p>Planning annuel interactif de production et diffusion</p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label>üìÖ Filtrer par mois:</label>
                <select id="filterMonth">
                    <option value="tous">Tous les mois</option>
                    <option value="MARS">Mars</option>
                    <option value="AVRIL">Avril</option>
                    <option value="MAI">Mai</option>
                    <option value="JUIN">Juin</option>
                    <option value="JUILLET">Juillet</option>
                    <option value="AO√õT">Ao√ªt</option>
                    <option value="SEPTEMBRE">Septembre</option>
                    <option value="OCTOBRE">Octobre</option>
                    <option value="NOVEMBRE">Novembre</option>
                    <option value="D√âCEMBRE">D√©cembre</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>üéØ Filtrer par statut:</label>
                <select id="filterStatus">
                    <option value="tous">Tous les statuts</option>
                    <option value="avenir">√Ä venir</option>
                    <option value="encours">En cours</option>
                    <option value="termine">Termin√©</option>
                </select>
            </div>
            
            <button class="btn" onclick="exportToExcel()">üì• Copier pour Excel</button>
            <button class="btn btn-secondary" onclick="resetFilters()">üîÑ R√©initialiser</button>
        </div>
        
        <div class="team-info">
            <div class="team-member">
                <strong>üë§ B2B:</strong> Guillaume
            </div>
            <div class="team-member">
                <strong>üè¢ Presta:</strong> Watt's Next
            </div>
            <div class="team-member">
                <strong>‚úçÔ∏è Relecture:</strong> Lidvine & Guillaume
            </div>
            <div class="team-member">
                <strong>üì¢ Communication:</strong> Geoffrey & Matthieu
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalNewsletters">10</div>
                <div class="stat-label">Newsletters 2026</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="nextDeadline">-</div>
                <div class="stat-label">Prochaine √©ch√©ance</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="daysUntil">-</div>
                <div class="stat-label">Jours restants</div>
            </div>
        </div>
        
        <div class="calendar-grid">
            <table id="calendarTable">
                <thead>
                    <tr>
                        <th class="main-header">Mois</th>
                        <th class="main-header">Statut</th>
                        <th class="main-header">Jours restants</th>
                        <th class="phase-presta" colspan="2">Presta ‚Üí B2B</th>
                        <th class="phase-b2b" colspan="2">B2B ‚Üí Presta</th>
                        <th class="phase-presta" colspan="2">Presta ‚Üí B2B</th>
                        <th class="phase-comm" colspan="2">B2B ‚Üí Communication</th>
                        <th class="phase-comm" colspan="2">Communication ‚Üí B2B</th>
                        <th class="phase-client">Communication ‚Üí Clients</th>
                    </tr>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th class="phase-presta">Proposition sujets</th>
                        <th class="phase-presta">Date butoire</th>
                        <th class="phase-b2b">Validation / ajustement</th>
                        <th class="phase-b2b">Date butoire</th>
                        <th class="phase-presta">Envoi r√©daction</th>
                        <th class="phase-presta">Date</th>
                        <th class="phase-comm">Relecture & modifs</th>
                        <th class="phase-comm">Date butoire</th>
                        <th class="phase-comm">BAT</th>
                        <th class="phase-comm">Date</th>
                        <th class="phase-client">Envoi newsletter</th>
                    </tr>
                </thead>
                <tbody id="calendarBody">
                </tbody>
            </table>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color phase-presta"></div>
                <span>Prestataire ‚Üí B2B</span>
            </div>
            <div class="legend-item">
                <div class="legend-color phase-b2b"></div>
                <span>B2B (Validation)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color phase-comm"></div>
                <span>Communication (Relecture & BAT)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color phase-client"></div>
                <span>Envoi aux clients</span>
            </div>
        </div>
    </div>

    <script>
        const newsletters = [
            { month: "JANVIER", dates: [] },
            { month: "F√âVRIER", dates: [] },
            { 
                month: "MARS",
                dates: ["18 f√©vr. 2026", "23 f√©vr. 2026", "2 mars 2026", "4 mars 2026", "4 mars 2026", "5 mars 2026"],
                finalDate: "2026-03-05"
            },
            { 
                month: "AVRIL",
                dates: ["18 mars 2026", "23 mars 2026", "2 avril 2026", "4 avril 2026", "4 avril 2026", "5 avril 2026"],
                finalDate: "2026-04-05"
            },
            { 
                month: "MAI",
                dates: ["20 avril 2026", "23 avril 2026", "29 avril 2026", "4 mai 2026", "5 mai 2026", "7 mai 2026"],
                finalDate: "2026-05-07"
            },
            { 
                month: "JUIN",
                dates: ["18 mai 2026", "20 mai 2026", "27 mai 2026", "1 juin 2026", "2 juin 2026", "4 juin 2026"],
                finalDate: "2026-06-04"
            },
            { 
                month: "JUILLET",
                dates: ["22 juin 2026", "24 juin 2026", "1 juillet 2026", "6 juillet 2026", "6 juillet 2026", "9 juillet 2026"],
                finalDate: "2026-07-09"
            },
            { 
                month: "AO√õT",
                dates: ["20 juillet 2026", "22 juillet 2026", "29 juillet 2026", "3 ao√ªt 2026", "4 ao√ªt 2026", "6 ao√ªt 2026"],
                finalDate: "2026-08-06"
            },
            { 
                month: "SEPTEMBRE",
                dates: ["19 ao√ªt 2026", "24 ao√ªt 2026", "31 ao√ªt 2026", "1 sept. 2026", "2 sept. 2026", "3 sept. 2026"],
                finalDate: "2026-09-03"
            },
            { 
                month: "OCTOBRE",
                dates: ["21 sept. 2026", "23 sept. 2026", "30 sept. 2026", "5 oct. 2026", "6 oct. 2026", "8 oct. 2026"],
                finalDate: "2026-10-08"
            },
            { 
                month: "NOVEMBRE",
                dates: ["19 oct. 2026", "21 oct. 2026", "28 oct. 2026", "2 nov. 2026", "3 nov. 2026", "5 nov. 2026"],
                finalDate: "2026-11-05"
            },
            { 
                month: "D√âCEMBRE",
                dates: ["18 nov. 2026", "23 nov. 2026", "30 nov. 2026", "2 d√©c. 2026", "2 d√©c. 2026", "3 d√©c. 2026"],
                finalDate: "2026-12-03"
            }
        ];

        function calculateStatus(finalDate) {
            if (!finalDate) return 'avenir';
            const today = new Date('2026-01-26');
            const target = new Date(finalDate);
            const diffDays = Math.ceil((target - today) / (1000 * 60 * 60 * 24));
            
            if (diffDays < 0) return 'termine';
            if (diffDays <= 7) return 'encours';
            return 'avenir';
        }

        function calculateDaysRemaining(finalDate) {
            if (!finalDate) return null;
            const today = new Date('2026-01-26');
            const target = new Date(finalDate);
            const diffDays = Math.ceil((target - today) / (1000 * 60 * 60 * 24));
            return diffDays;
        }

        function getStatusBadge(status) {
            const badges = {
                'termine': '<span class="status-badge status-termine">‚úì Termin√©</span>',
                'encours': '<span class="status-badge status-encours">‚ö° En cours</span>',
                'avenir': '<span class="status-badge status-avenir">üìÖ √Ä venir</span>'
            };
            return badges[status] || '';
        }

        function renderCalendar() {
            const tbody = document.getElementById('calendarBody');
            tbody.innerHTML = '';
            
            newsletters.forEach(item => {
                const status = calculateStatus(item.finalDate);
                const daysRemaining = calculateDaysRemaining(item.finalDate);
                const row = document.createElement('tr');
                row.setAttribute('data-month', item.month);
                row.setAttribute('data-status', status);
                
                if (item.dates.length === 0) {
                    row.innerHTML = `
                        <td class="month">${item.month}</td>
                        <td class="empty"></td>
                        <td class="empty"></td>
                        <td class="empty" colspan="11"></td>
                    `;
                } else {
                    const daysText = daysRemaining !== null ? 
                        (daysRemaining < 0 ? 'Pass√©' : `J-${daysRemaining}`) : '';
                    
                    row.innerHTML = `
                        <td class="month">${item.month}</td>
                        <td>${getStatusBadge(status)}</td>
                        <td class="days-remaining"><strong>${daysText}</strong></td>
                        <td class="date-cell phase-presta">Proposition</td>
                        <td class="date-cell phase-presta">${item.dates[0]}</td>
                        <td class="date-cell phase-b2b">Validation</td>
                        <td class="date-cell phase-b2b">${item.dates[1]}</td>
                        <td class="date-cell phase-presta">R√©daction</td>
                        <td class="date-cell phase-presta">${item.dates[2]}</td>
                        <td class="date-cell phase-comm">Relecture</td>
                        <td class="date-cell phase-comm">${item.dates[3]}</td>
                        <td class="date-cell phase-comm">BAT</td>
                        <td class="date-cell phase-comm">${item.dates[4]}</td>
                        <td class="date-cell phase-client"><strong>${item.dates[5]}</strong></td>
                    `;
                    
                    if (status === 'encours') {
                        row.classList.add('highlight-upcoming');
                    }
                }
                
                tbody.appendChild(row);
            });
            
            updateStats();
        }

        function updateStats() {
            const upcomingNewsletters = newsletters.filter(n => n.finalDate && calculateStatus(n.finalDate) !== 'termine');
            
            if (upcomingNewsletters.length > 0) {
                const nextNewsletter = upcomingNewsletters[0];
                const daysRemaining = calculateDaysRemaining(nextNewsletter.finalDate);
                document.getElementById('nextDeadline').textContent = nextNewsletter.dates[5];
                document.getElementById('daysUntil').textContent = daysRemaining >= 0 ? daysRemaining : '0';
            }
        }

        function applyFilters() {
            const monthFilter = document.getElementById('filterMonth').value;
            const statusFilter = document.getElementById('filterStatus').value;
            const rows = document.querySelectorAll('#calendarBody tr');
            
            rows.forEach(row => {
                const month = row.getAttribute('data-month');
                const status = row.getAttribute('data-status');
                
                const monthMatch = monthFilter === 'tous' || month === monthFilter;
                const statusMatch = statusFilter === 'tous' || status === statusFilter;
                
                row.style.display = (monthMatch && statusMatch) ? '' : 'none';
            });
        }

        function resetFilters() {
            document.getElementById('filterMonth').value = 'tous';
            document.getElementById('filterStatus').value = 'tous';
            applyFilters();
        }

        function exportToExcel() {
            const table = document.getElementById('calendarTable');
            let text = '';
            
            for (let row of table.rows) {
                const cols = [];
                for (let cell of row.cells) {
                    cols.push(cell.innerText);
                }
                text += cols.join('\t') + '\n';
            }
            
            navigator.clipboard.writeText(text).then(() => {
                alert('‚úÖ Tableau copi√© ! Colle-le dans Excel avec Ctrl+V');
            });
        }

        document.getElementById('filterMonth').addEventListener('change', applyFilters);
        document.getElementById('filterStatus').addEventListener('change', applyFilters);

        renderCalendar();
    </script>
</body>
</html>
